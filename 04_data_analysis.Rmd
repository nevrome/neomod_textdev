---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Datenauswertung

## Technische Umsetzung

Die vorliegende Arbeit wurde in sechs verschiedenen Teilprojekten entwickelt und hat mindestens drei Hilfsprojekte hervorgebracht oder inspiriert (siehe Tabelle \@ref(tab:projects)). Alle diese Projekte wurden und werden unabhängig voneinander mit der Versionskontrollsoftware Git^[https://git-scm.com/ [31.07.2018]] überwacht, die den Arbeitsfortschritt in vielen hundert einzeln kommentierten Veränderungspaketen -- "Commits" -- dokumentiert. Der Entstehungsprozess ist damit weitreichend nachvollziehbar, sieht man von Vorüberlegungen und Gesprächen ab, die keine konkreten Ergebnisse gezeitigt haben. Nach Abschluss von Korrektur und Revision der Arbeit, werden alle Projekte über die Cloud Plattform Github ^[https://github.com/ [31.07.2018]] zugänglich gemacht werden. Die im Text verarbeitete und darüber hinaus gesammelte Literatur ist in drei thematisch getrennte Sammlungen gegliedert (siehe Tabelle \@ref(tab:libraries)) und über das zotero Webportal einsehbar.   

```{r projects, echo=FALSE, tidy=FALSE}
library(magrittr)

tibble::tibble(
  name = c(
    "neomod\\_textdev",
    "neomod\\_prepresentation",
    "neomod\\_analysis",
    "neomod\\_datapool",
    "popgenerator",
    "gluesless",
    "c14bazAAR",
    "neimann1995",
    "rdoxygen"
  ),
  link = c(
    "\\href{https://www.github.com/nevrome/neomod\\_textdev}{github/nevrome/neomod\\_textdev}",
    "\\href{https://www.github.com/nevrome/neomod\\_prepresentation}{github/nevrome/neomod\\_prepresentation}",
    "\\href{https://www.github.com/nevrome/neomod\\_analysis}{github/nevrome/neomod\\_analysis}",
    "",
    "\\href{https://www.github.com/nevrome/popgenerator}{github/nevrome/popgenerator}",
    "\\href{https://www.github.com/nevrome/gluesless}{github/nevrome/gluesless}",
    "\\href{https://www.github.com/nevrome/c14bazAAR}{github/nevrome/c14bazAAR}",
    "\\href{https://www.github.com/nevrome/neimann1995}{github/nevrome/neimann1995}",
    "\\href{https://www.github.com/nevrome/rdoxygen}{github/nevrome/rdoxygen}"
  ),
  description = c(
    "Textproduktion. Der Text der Masterarbeit wurde in R Markdown\\tablefootnote{\\url{https://rmarkdown.rstudio.com/ [31.07.2018]}} mit im bookdown Framework\\tablefootnote{\\url{\\textcite{xie_bookdown_2016}; \\textcite{xie_bookdown_2018}; https://bookdown.org/ [31.07.2018]}} verfasst. Da ausschließlich das Rendern mittels Pandoc\\tablefootnote{\\url{https://pandoc.org/ [31.07.2018]}} in LaTeX\\tablefootnote{\\url{https://www.latex-project.org/ [31.07.2018]}} ins PDF Format vorgesehen war, enthält die Textvorlage auch vereinzelt LaTeX Ausdrücke. Jeder Commit löst dank Continous Integration mit Travis\\tablefootnote{\\url{https://travis-ci.com/ [31.07.2018]}} ein automatisches Rendern des Texts aus.",
    "Präsentationen über die Inhalte der Masterarbeit. Vor- während und nach der Arbeit wurden mehrere Präsentation über Planung, Arbeitsfortschritt und Ergebnisse zusammengestellt. Die Präsentationen sind jeweils in R Markdown konstruiert, unterscheiden sich aber je nachdem, ob ein Rendern in HTML oder PDF vorgesehen war.",
    "Datenanalyse. Sowohl die Realweltdaten als auch die Daten aus der Simulation wurden mit R ausgewertet. Dieses Projekt hat bewusst nicht die Form eines R Pakets, sondern setzt sich aus vielen einzelnen, teilweise redundanten R Skripten zusammen.",
    "Datenhaltung. Dieses Projekt speichert Eingangs- und Ergebnisdaten. Es unterliegt aufgrund der Datenmenge keiner Versionskontrolle. Das Repository enthält nur ein Skript, um das Verzeichnisskelett zu konstruieren und Geodaten herunterzuladen. Alle weiteren Inhalte werden in neomod\\_analysis generiert.",
    "Populationsgenerator. R Paket zur Konstruktion von Populationsgraphen.",
    "Expansionsmodell. C++ Programm zur Simulation der Ausbreitung von Ideen in einem Populationsgraphen, wie er von popgenerator erzeugt wird.",
    "\\textsuperscript{14}C-Datenbeschaffung. R Paket zum strukturierten Download von \\textsuperscript{14}C-Daten aus verschiedenen Quelldatenbanken -- unter anderem der hier verarbeiteten Radon-B Datenbank.",
    "Reproduktion eines Artikels. Verständnisübung entlang eines der wesentlichen Artikel in der theoretischen Vorbereitung dieser Arbeit.",
    "Doxygen Dokumentation. R Paket um Doxygen Dokumentation für Source Code in R Paketen zu erstellen."
  ) 
) %>%
  dplyr::transmute(
    Projekt = paste0("\\textbf{", name, "}", "\n", link),
    Beschreibung = description
  ) %>%
  dplyr::mutate_all(
    kableExtra::linebreak
  ) %>%
  knitr::kable(
    caption = "Projekte, die im Kontext der Entwicklung dieser Arbeit angelegt wurden.",
    format = "latex",
    booktabs = T,
    escape = F
  ) %>%
  kableExtra::kable_styling(full_width = F) %>%
  kableExtra::column_spec(1, width = "20em") %>%
  kableExtra::column_spec(2, width = "25em")
```

```{r libraries, echo=FALSE, tidy=FALSE}
tibble::tibble(
  name = c(
    "cultural\\_evolution",
    "bronze\\_age\\_burials",
    "software\\_packages"
  ),
  link = c(
    "\\href{https://www.zotero.org/groups/2086516/cultural\\_evolution}{zotero/cultural\\_evolution}",
    "\\href{https://www.zotero.org/groups/2199051/bronze\\_age\\_burials}{zotero/bronze\\_age\\_burials}",
    "\\href{https://www.zotero.org/groups/2211203/software\\_packages}{zotero/software\\_packages}"
  ),
  description = c(
    "Cultural Evolution. Literatursammlung zu Cultural Evolution und ihren vielen Subthemen wie Memetik, Cultural Transmission oder Sozial Learning. Geht weit über eine rein archäologische Perspektive hinaus, umfasst aber gleichzeitig archäologische Fallstudien ohne großen theoretischen Selbstanspruch.",
    "Bestattungssitten in der Bronzezeit. Archäologische Literatur zur Theorie der Thanatoarchäologie und zur kulturhistorischen Entwicklung in der Bronzezeit.",
    "Software. Referenzen von wissenschaftlicher Software, die für Datenverarbeitung sowie Text- und Abbildungsvorbereitung zum Einsatz gekommen ist. Vor allem R Pakete und C++ Bibliotheken."
  ) 
) %>%
  dplyr::transmute(
    Bibliothek = paste0("\\textbf{", name, "}", "\n", link),
    Beschreibung = description
  ) %>%
  dplyr::mutate_all(
    kableExtra::linebreak
  ) %>%
  knitr::kable(
    caption = "Literatursammlungen, die im Kontext der Entwicklung dieser Arbeit angelegt wurden.",
    format = "latex",
    booktabs = T,
    escape = F
  ) %>%
  kableExtra::kable_styling(full_width = F) %>%
  kableExtra::column_spec(1, width = "20em") %>%
  kableExtra::column_spec(2, width = "25em")
```

Die gesamte Datenanalyse wurde in der Statistikprogrammiersprache R^[@RCoreTeamLanguageEnvironmentStatistical2016] implementiert. Dabei kam neben Funktionen aus Basispaketen auch eine große Anzahl von Community-Paketen zum Einsatz, inklusiver mehrerer selbst entwickelter. Aufgrund der sonst unangemessen großen Menge an Referenzen, werden im folgenden nur die Pakete genannt, deren Funktionen tatsächlich unmittelbar aufgerufen wurden und nicht deren oft umfangreiche Sammlung an Abhängigkeiten. Die Zusammenstellung umfasst jedoch auch Pakete, die im Laufe der Entwicklung intensiv zum Einsatz kamen, dann aber aufgrund inhaltlicher oder technischer Veränderungen ersetzt werden mussten. Über die Entwicklungszeit dieser Arbeit haben sich viele der verwendeten Pakete ebenfalls weiterentwickelt -- die angebene Versionsnummer bezieht sich auf diejenige, mit der die in Version 1.0 dieser Arbeit abgedruckten Ergebnisse erstellt wurden. 
<!--purrr::map(c("broom", "dplyr"), function(x) {toBibtex(citation(x))})-->
Folgende Pakete kamen zum Einsatz zur Text- und Literaturverarbeitung (bookdown^[@xie_bookdown_2016; @xie_bookdown_2018], citr^[@aust_citr_2017], knitr^[@xie_dynamic_2015; @xie_knitr_2014; @xie_knitr_2018], markdown^[@allaire_markdown_2017], rmarkdown^[@allaire_rmarkdown_2018]), zur Datenbeschaffung (c14bazAAR), zur allgemeinen Datenmanipulation (broom^[@robinson_broom_2018], dplyr^[@wickham_dplyr_2018], forcats, kableExtra^[@zhu_kableextra_2018], purrr^[@henry_purrr_2018], readr^[@wickham_readr_2017], stringi^[@gagolewski_r_2018], stringr^[@wickham_stringr_2018], tibble^[@muller_tibble_2018], tidyr^[@wickham_tidyr_2018], reshape, reshape2), zur Graphikerstellung (ggplot2), für geographische Analysen (sp, sf), für statistische Analysen und Spezialdatenverarbeitung (Bchron^[@haslett_simple_2008]), zur Erstellung von WebApps und Interaktiven Präsentationen im Shiny Framework (shiny^[@chang_shiny_2018]) und zur allgemeinen Arbeit und Paketentwicklung in R (devtools^[@wickham_devtools_2018], magrittr^[@bache_magrittr_2014], Rcpp^[@eddelbuettel_extending_2017; @eddelbuettel_rcpp_2011; @eddelbuettel_seamless_2013], rlang^[@henry_rlang_2018], roxygen2^[@wickham_roxygen2_2017], testthat^[@wickham_testthat_2011]). 

Die Expansionssimultion gluesless ist in C++^[@standard-cpp-foundation_international_2017] umgesetzt, um auf dessen höhere Geschwindigkeit und bessere Werkzeuge für objektorientiertes Programmieren zurückgreifen zu können. Zur Abbildung des Populationsgraphen kam zunächst die Boost Graph Library^[https://www.boost.org/doc/libs/1_67_0/libs/graph [01.08.2018]; @siek_boost_2002] (BGL) zum Einsatz, wurde dann aber aufgrund von Performance-Problemen durch die C++ Bibliothek des Stanford Network Analysis Project^[https://snap.stanford.edu/ [01.08.2018]; @leskovec2016snap] (SNAP) abgelöst. 

## Datensatz Radon-B {#radonb_dataset}

Radon-B^[@kneisel_radon-b_2013] ist eine öffentlich verfügbare Datenbank, die einzelne Radiokohlenstoffdatierungen -- ^14^C-Daten -- aus der Bronze- und Frühen Eisenzeit in Europa sammelt. Sie konzentriert sich auf ein Zeitfenster zwischen 2300 bis 500calBC ab, enthält jedoch auch Daten jenseits dieses Limits. Neben Radon-B steht mit ihrer Schwesterdatenbank Radon[@martin_hinz_radon_2012] eine strukturell äquivalente Sammlung mit einem Schwerpunkt auf neolithischen Daten zur Verfügung. Jedes Datum ist mit Kerndaten und Metainformationen verknüpft (siehe Tabelle \@ref(tab:radonbparams)). Die Informationen wurden aus einzelnen Publikationen zusammengetragen und sind teilweise unvollständig, inkonsistent oder fehlerhaft (siehe Kapitel \@ref(source_criticism)).

```{r radonbparams, echo=FALSE, tidy=FALSE}
tibble::tibble(
  param = c(
    "ID",
    "Lab Code + Lab Nr.",
    "BP (Before Present)",
    "Std (Standard deviation)",
    "$\\delta$\\textsuperscript{13}C",
    "$\\delta$\\textsuperscript{13}C Std",
    "Sample Material",
    "Sample Material Comment",
    "Feature Type",
    "Feature",
    "Culture",
    "Phase",
    "Site",
    "Country",
    "Country Subdivision",
    "Literature",
    "Comment"
  ),
  examples = c(
    "",
    "z.B. Ua-25144, OxA-1602, HAR-4341",
    "",
    "",
    "",
    "",
    "z.B. charcoal, bone, seed",
    "z.B. hazel, oak, barley, boar",
    "z.B. settlement (house), rockshelter, 	Grave (cremation)",
    "z.B. House I, from a mass of burnt debris...",
    "z.B. Late Bronze Age, Únětice, Nordic Bronze Age",
    "z.B. Nagyrév Group, Mierzanowice, Period III",
    "z.B. La Croix-Saint-Ouen, Stedten, Byneset",
    "z.B. Germany, France, Poland",
    "z.B. Baden-Württemberg, Surrey, Greater Poland",
    "",
    ""
  ),
  description = c(
    "Eine datenbankspezifische, individuelle Kennnummer.",
    "Die allgemeine, individuelle Kennnummer, die sich aus einem Kürzel des Labors, das die Messung durchgeführt hat, und einer fortlaufenden, laborspezifischen Prozessnummer zusammensetzt.",
    "Das \\textsuperscript{14}C-Alter, das mit der Messung ermittelt wurde in Jahren vor 1950 nach Christus [uncalBP].",
    "Die messbedingte Standardabweichung des \\textsuperscript{14}C-Alters.",
    "Ein Maß für das Isotopenverhältnis des stabilen Isotops \\textsuperscript{13}C / \\textsuperscript{12}C zwischen der Probe und einem Standard in Promille [\\textperthousand].",
    "Die Standardabweichung des $\\delta$\\textsuperscript{13}C-Werts.",
    "Oberkategorie des Probenmaterials.",
    "Nähere Kategorisierung und Artenzuordnung des Probenmaterials.",
    "Befund bzw. Fundplatzkategorie, aus dem das Probenmaterial stammt.",
    "Bezeichnung des Befunds in der Grabungsdokumentations des Fundplatzes.",
    "Allgemeine, archäologische Kultur- oder Phasenzuordnung des Probenkontexts.",
    "Präzisere Kultur- oder Kontextansprache.",
    "Bezeichnung des Fundplatzes, aus dem die Probe stammt.",
    "Land in dem der Fundplatz liegt.",
    "Zugehörige administrative Region innerhalb des Landes.",
    "Literaturreferenz auf die Publikation aus der die Informationen über das Datum entnommen wurden.",
    "Freitextkommentarfeld mit Zusatzinformationen zu dem einzelen Datum."
  ) 
) %>%
  dplyr::transmute(
    Parameter = paste0("\\textbf{", param, "}", "\n", examples),
    Beschreibung = description
  ) %>%
  dplyr::mutate_all(
    kableExtra::linebreak
  ) %>%
  knitr::kable(
    caption = "Parameter, die in Radon-B für jedes Datum vorliegen.",
    format = "latex",
    booktabs = T,
    escape = F
  ) %>%
  kableExtra::kable_styling(full_width = F) %>%
  kableExtra::column_spec(1, width = "20em") %>%
  kableExtra::column_spec(2, width = "25em")
```

### Datenvorbereitung und Gliederung {#data_prep_and_segmentation}

Eine inhaltlich etwas reduzierte^[Für einen Überblick, welche Variablen heruntergeladen und wie umbenannt werden: https://github.com/ISAAKiel/c14bazAAR/blob/master/data-raw/variable_reference.csv], aber hier ausreichende Version von Radon-B wurde mittels des R Pakets c14bazAAR^[] direkt in R bezogen. Der erste Datenverarbeitungsschritt war das Entfernen aller Daten ohne Altersinformation und aller Daten außerhalb der theoretischen Reichweite der Kalibrationskurve. Die Reichweite der im R Paket Bchron^[@haslett_simple_2008] enthaltenen Version es IntCal13 Datensatzes^[@reimer_intcal13_2013], die auch für die eigentliche Kalibration verwendet wurde beträgt 71-46401calBP. Bchron berechnet das kalibrierte Alter mittels Numerischer Integration^[https://github.com/andrewcparnell/Bchron/blob/master/R/BchronCalibrate.R [02.08.2018]] und liefert für jedes Datum eine normierte Wahrscheinlichkeitskurve. Alter mit Wahrscheinlichkeiten unterhalb eines Schwellwerts von $1\mathrm{e}{-6}$ wurden abgeschnitten und Alter innerhalb des $2\sigma$ Wahrscheinlichkeitsbereichs gesondert markiert. Die so erhaltenen, unterschiedlich wahrscheinlichen Alter für jedes einzelne Datum wurden ab hier von calBP in calBC umgerechnet, um üblichen archäologischen Konventionen und dem allgemeinen Sprachgebrauch zu entsprechen.    

### Deskriptive Analyse

...

```{r full-dataset-map, echo = FALSE, fig.cap = "Abbildung"}
#knitr::include_graphics("/home/clemens/neomod/neomod_datapool/bronze_age/disp_map_full.jpeg")
```

```{r cremation-inhumation-amount-development, echo = FALSE, fig.cap = "Abbildung"}
#knitr::include_graphics("/home/clemens/neomod/neomod_datapool/bronze_age/amount_development_regions_cremation_inhumation.jpeg")
```

```{r cremation-inhumation-proportion-development, echo = FALSE, fig.cap = "Abbildung"}
#knitr::include_graphics("/home/clemens/neomod/neomod_datapool/bronze_age/proportions_development_regions_cremation_inhumation.jpeg")
```

Abbildung \@ref(fig:cremation-inhumation-amount-development) zeigt, wie sich die C14-Daten in RADON-B räumlich und zeitlich verteilen.

### Quellenkritik {#source_criticism}

Für einzelne Regionen liegen für gewisse Zeiträume verhältnismäßig viele Daten vor, für die Mehrzahl der Regionen ist die Datenmenge allerdings sehr gering. Diese Ungleichverteilung der Daten kann viele verschiedene Gründe haben: 

- Schwerpunkte der Datenaufnahme für RADON-B nach Forschungsinteressen der beteiligten Wissenschaftler.
- Regionale und zeitliche Ausrichtung von Forschungsprojekten, in deren Rahmen die C14-Daten erstellt wurden. Damit zusammen hängt die politische Rahmensituation, die C14-Datierung in größerem Umfang z.B. in den Osteuropäischen Staaten erst nach dem Zusammenbruch der Sowjetunion möglich gemacht hat. 
- Forschungstraditionen
- Erhaltungssituation organischer Funde
- Dateneingabe in RADON-B (Wo sind Grabmetainformationen beigelegt?)
- weitere mögliche Bestattungsformen, die archäologisch nicht fassbar sind

Das scheint sich auch im RADON-B Datensatz abzubilden: In fast allen Untersuchungsregionen dominieren zum Ende hin Brandbestattungen (siehe Abbildung \@ref(fig:cremation-inhumation-proportion-development).

Diesen Umstand gibt RADON-B in Ermangelung entsprechender Daten leider nicht wieder (siehe Abbildung \@ref(fig:full-dataset-map))


## Simulation

### Theoretische Grundlage und Funktionalität

Wie werden warum welche Gegebenheiten der realen Welt im Modell abgebildet?

### Implementierung

### Simulationsparameter

### Allgemeine Beobachtungen zum Simulationsverhalten

## Kulturelle und Räumliche Distanz

## Kausale Interaktionsbeziehungen

## Simulation und reale Entwicklung

...



\pby[title={Literatur},segment=\therefsegment,heading=subbibintoc]
